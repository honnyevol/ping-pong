<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            margin: 0px;
            background-color: tomato;
        }
        #dvPainel{
            display: flex;
            height: 50px;
            align-items: center;
        }
        .itemPainel{
            margin: 5px;
        }
        #dvJogo{
            width: 960px;
            height: 500px;
            border: 1px solid #000;
            background-color:tomato;
        }
        #dvBola{
            position: absolute;
            top: 240px;
            left: 475px;
            width: 20px;
            height: 20px;
            background-color: #000;
        }
        .barra{
            position: absolute;
            width: 20px;
            height: 140px;
            background-color: #000;
            top: 180px;
        }
        .esquerda{
            left:10px;
        }
        .direita{
            left:930px;
        }
    </style>
    <script>
        var vbtIniciar;
        var vbola;
        var vcpu;
        var vjogador;
        var vPaineltxtPontos;
        var game;
        var frames;
        var posBolaX;
        var posBolaY;
        var posJogadorX =0;
        var posJogadorY;
        var posCpuX=940;
        var posCpuY;
        var dirJy;
        var posJogIniY=180;
        var posCpuIniY=180;
        var posBolaIniX=475;
        var posBolaIniY=240;
        var campoX=0;
        var campoY=0;
        var campoW=960;
        var campoH=500;
        var barraW=20;
        var barraH=140;
        var bolaW=20;
        var bolaH=20;
        var bolaX;
        var bolaY;
        var cpuY=0;
        var velBola;
        var velCpu;
        var velJogador;
        var pontos=0;
        var tecla;
        jogo=false;
        function controlajog(){
            if(jogo){
                posJogadorY+=velJogador*dirJy;
                if(((posJogadorY+barraH)>=campoH)||((posJogadorY)<=0)){
                    posJogadorY+=(velJogador*dirJy)*(-1);
                }
                vjogador.style.top=posJogadorY+'px';
            }
        }
        function controlacpu(){
            if (jogo) {
                if((posBolaX>(campoW/2))&&(bolaX>0)){
                    if(((posBolaY+(bolaH/2))>((posCpuY+(barraH/2)))+velCpu)){
                        if((posCpuY+barraH)<=campoH){
                            posCpuY+=velCpu;
                        }
                    }else if((posBolaY+(bolaH/2))<(posCpuY+(barraH/2))-velCpu){
                        if(posCpuY>=0){
                            posCpuY-=velCpu;
                        }
                    }
                }else{
                    if((posCpuY + (barraH/2))<(campoH/2)){
                        posCpuY+=velCpu;
                    }else if((posCpuY+(barraH/2))>(campoH/2)){
                        posCpuY-=velCpu;
                    }

                }
                vcpu.style.top=posCpuY+"px";
            }
        }
        function controlaBola(){
            posBolaX+=velBola*bolaX;
            posBolaY+=velBola*bolaY;
            if((posBolaX  <= posJogadorX+barraW)&&((posBolaY+bolaH >= posJogadorY)&&(posBolaY <= posJogadorY+barraH))
            ){
                bolaY=(((posBolaY+(bolaH/2))-(posJogadorY+(barraH/2)))/16);
                bolaX*=-1;
            }
            if((posBolaX >= posCpuX-barraW)&&((posBolaY+bolaH >= posCpuY)&&(posBolaY <= posCpuY+barraH))
            ){
                bolaY=(((posBolaY+(bolaH/2))-(posJogadorY+(barraH/2)))/16);
                bolaX*=-1;
            }
            if((posBolaY>=480)||(posBolaY<=0)){
                bolaY*=-1;
            }
            if(posBolaX>=(campoW - bolaW)){
                velBola=0;
                posBolaX=posBolaIniX;
                posBolaY=posBolaIniY;
                posJogadorY=posJogIniY;
                posCpuY=posCpuIniY;
                pontos++;
                vPaineltxtPontos.value=pontos;
                jogo=false;
                vjogador.style.top=posJogadorY+'px';
                vcpu.style.top=posCpuY+'px';
            }else if(posBolaX<=0){
                velBola=0;
                posBolaX=posBolaIniX;
                posBolaY=posBolaIniY;
                posJogadorY=posJogIniY;
                posCpuY=posCpuIniY;
                pontos--;
                vPaineltxtPontos.value=pontos;
                jogo=false;
                vjogador.style.top=posJogadorY+'px';
                vcpu.style.top=posCpuY+'px';
            }
            vbola.style.top=posBolaY+"px";
            vbola.style.left=posBolaX+"px";
        }
        function teclaDw(){
            tecla = event.keyCode;
            if(tecla==38){
                dirJy=-1;
            }else if(tecla==40){
                dirJy=+1;
            }
        }
        function teclaUp(){
            tecla = event.keyCode;
            if(tecla==38){
                dirJy=0;
            }else if(tecla==40){
                dirJy=0;
            }
        }
        function game(){
            if(jogo){
                controlajog();
                controlaBola();
                controlacpu();
            }
            frames=requestAnimationFrame(game);
        }
        function iniciaJogo(){
            velBola=8;
            velCpu=8;
            velJogador=8;
           if(!jogo){
               cancelAnimationFrame(frames);
            jogo = true;
            dirJy=0;
            bolaY=0;
            if((Math.random()*10)<5){
                bolaX=-1;
            }else{                                                  
                bolaX=1;
            }
            posBolaX = posBolaIniX;
            posBolaY = posBolaIniY;
            posJogadorY =posJogIniY;
            posCpuY=posCpuIniY;
            game();
        }
        }
        function inicializa(){
            velBola=8;
            velCpu=8;
            velJogador=8;
            vbtIniciar=document.getElementById("btIniciar");
            vbtIniciar.addEventListener('click',iniciaJogo);
            vjogador=document.getElementById('dvJogador');
            vcpu=document.getElementById('dvCpu');
            vbola=document.getElementById("dvBola");
            vPaineltxtPontos=document.getElementById('txtPontos');
            document.addEventListener('keydown',teclaDw);
            document.addEventListener('keyup',teclaUp);
            
        }
        window.addEventListener('load',inicializa);
    </script>
</head>
<body>
    <div id="dvJogo">
        <div id="dvBola"></div>
        <div id="dvJogador" class="barra esquerda"></div>
        <div id="dvCpu" class="barra direita"></div>
    
    </div>
    <div id="dvPainel">
        <div class="itemPainel">
        <label>Pontos</label>
        <input type="text" id="txtPontos" value="0" size="10">
        </div>
        <div class="itemPainel">
            <button id="btIniciar">iniciar</button>
        </div>
    </div>

</body>
</html>